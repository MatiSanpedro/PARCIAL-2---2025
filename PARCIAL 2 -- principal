import pygame as pg
import time
from PARCIAL_2_funciones import *
from PARCIAL_2_configuraciones import * 
import os

correccion_tamaño_menu = pg.transform.scale(pantalla, (900,700)) #esto corrige el tamaño del fondo 



#Bucle principal
while True:
    reloj.tick(60)
    
    
    for evento in pg.event.get():
        if evento.type == pg.QUIT:
            pg.quit()
            quit()

        match pantalla_actual:

            
            case "inicio": #este case es la pantalla principal del menu

                pantalla.blit(correccion_fondo_pantalla,(0,0)) #fondo de pantalla

                pantalla.blit(nivel,(300,100)) #boton 1 
                pantalla.blit(texto1,(390, 100)) #texto 1

                pantalla.blit(jugar,(300,245))#boton2
                pantalla.blit(texto_2,(390,245))#texto2

                pantalla.blit(boton_puntaje,(300,390))#boton3
                pantalla.blit(texto_3,(354, 390))#texto3
                
                pantalla.blit(boton_salida,(300,540)) #boton4
                pantalla.blit(texto_4,(360,540))#texto4 
                
                #eventos del mouse - pantalla de inicio: 
                if evento.type == pg.MOUSEBUTTONDOWN: 
                    if evento.button == 1: #click derecho 
                        posicion = evento.pos   #posicion del click
                        print(f"click en {posicion}")

                        if boton1.collidepoint(posicion):#click boton1 "Nivel"                
                            pantalla_actual = "nivel"
                            print("Nivel Presionado")

                        elif boton2.collidepoint(posicion):#click boton2 "Jugar"
                            pantalla_actual = "jugar"
                            print("Jugar presionado")


                        elif boton3.collidepoint(posicion): #click boton3 "Ver Puntaje"
                            pantalla_actual = "ver puntaje"
                            print("Puntaje presionado")
                        
                        elif boton4.collidepoint(posicion): #click boton4 "Salir"
                            print("saliendo del juego.")
                            pg.quit()
                            quit()


            
            case "nivel":

                #blits de los rect de los botones 
                pantalla.blit(correccion_tamaño_nivel,(0, 0))  #corrector de tamaño de fondo
                pantalla.blit(nivel_nivel ,(250,50)) #rectangulo 1
                pantalla.blit(texto_facil,(250,50)) #texto 1 

                pantalla.blit(medio,(250,150)) #rectangulo 2 
                pantalla.blit(texto_medio ,(250,150)) #texto 2 

                pantalla.blit(dificil,(250,250)) #rectangulo 3 
                pantalla.blit(texto_dificil,(250,250)) #texto 3

                pantalla.blit(volver, (250, 350)) #rectangulo volver
                pantalla.blit(texto_4_nivel,(250,350)) #texto volver
                
                
                

                #mouse:
                if evento.type == pg.MOUSEBUTTONDOWN: 
                        posicion = (evento.pos)


                        if evento.button ==1:
                            print(" ")

                        if boton1_nivel.collidepoint(posicion):         
                            modo_dificultad = "facil"    #dificultad
                            pantalla_actual = "inicio"   #vuelvo a inicio automaticamente en todos los casos
                            print("modo facil seleccionado")


                        elif boton2_nivel.collidepoint(posicion):
                            modo_dificultad = "medio"
                            pantalla_actual = "inicio"
                            print("modo medio seleccionado")


                        elif boton3_nivel.collidepoint(posicion):
                            modo_dificultad = "dificil"
                            pantalla_actual = "inicio"
                            print("modo dificil seleccionado")


                        elif boton4_nivel.collidepoint(posicion):
                            pantalla_actual = "inicio"

                
            case "jugar":
                pantalla.fill((189, 162, 162))#color de fondo de pantalla durante el juego
                pantalla.blit(texto_de_puntaje,rect_de_texto_puntaje)#blit de texto "puntaje"
                pantalla_actual = pausar_juego(evento,pantalla_actual) #controlador de pantalla
                #ESC = volver a inicio - pausar
                

                #dibujos de celdas - cuadrados
                celdas_sector_1 = dibujar_cuadrados(pantalla,50,3,3,150,150) #sector 1
                celdas_sector_2 = dibujar_cuadrados(pantalla,50,3,3,300,150) #sector 2
                celdas_sector_3 = dibujar_cuadrados(pantalla,50,3,3,450,150) #sector 3
                celdas_sector_4 = dibujar_cuadrados(pantalla,50,3,3,150,300) #sector 4
                celdas_sector_5 = dibujar_cuadrados(pantalla,50,3,3,300,300) #sector 5
                celdas_sector_6 = dibujar_cuadrados(pantalla,50,3,3,450,300) #sector 6
                celdas_sector_7 = dibujar_cuadrados(pantalla,50,3,3,150,450) #sector 7 
                celdas_sector_8 = dibujar_cuadrados(pantalla,50,3,3,300,450) #sector 8
                celdas_sector_9 = dibujar_cuadrados(pantalla,50,3,3,450,450) #sector 9 
                
                #union de matrices:
                todas_las_celdas = (celdas_sector_1 + celdas_sector_2 + celdas_sector_3 +
                                    celdas_sector_4 + celdas_sector_5 + celdas_sector_6 +
                                    celdas_sector_7 + celdas_sector_8 + celdas_sector_9)

                dibujar_lineas(pantalla) #son las 4 lineas que separan los 9 espacios de la cuadricula
                
                #Dibujar numeros:
                matriz_general_dibujos = dibujar_numeros(pantalla,matriz_general_fin,tamaño, fuente,150,150)
                
                #Detector de colisiones:
                if evento.type == pg.MOUSEBUTTONDOWN:
                    posicion = (evento.pos) #posicion    
                    celda_seleccionada = detectar_celda(posicion,todas_las_celdas) #detecta celda seleccionada
                
                #ingresar numero por teclado
                if evento.type == pg.KEYDOWN and celda_seleccionada is not None:
                    numero_ingresado = input_numero(evento,celda_seleccionada)

                    if numero_ingresado is not None:
                        matriz_general_fin = ingresar_numero_a_matriz(matriz_general_fin,numero_ingresado,celda_seleccionada,tamaño)
                        print(matriz_general_fin)

                pg.display.update()

            case "ver puntaje":
                pass
                         
    

    pg.display.flip()
